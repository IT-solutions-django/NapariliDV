{% extends 'base.html' %} 
{% load static %} 
{% load price_filters %}

{% block title %}
{{ project.name }}
{% endblock %}

{% block content %}
    <div class="breadcrumbs container font__inter">
        <div>
            <a href="{% url 'home:home' %}">Главная</a>
        </div>
        <div>
            <img src="{% static 'images/right-gray-arrow.svg' %}" alt="">
        </div>
        <div>
            <a href="{% url 'projects:catalog' %}">Каталог</a>
        </div>
        <div>
            <img src="{% static 'images/right-gray-arrow.svg' %}" alt="">
        </div>
        <div>
            <a href="{{ project.get_absolute_url }}">{{ project.name }}</a>
        </div>
    </div>

    <div class="project container">
        <div class="project__slider">
            <div class="project__current-slide" href="">
                {% for photo in project.photos.all %}
                    <div>
                        <a href="{{ photo.image.url }}">
                            <img src="{{ photo.image.url }}" alt="">
                        </a>
                    </div>
                {% endfor %}
            </div>
           
            <div class="project__slider-nav">
                {% for photo in project.photos.all %}
                    <div class="project__slide">
                        <img src="{{ photo.image.url }}" alt="">
                    </div>
                {% endfor %}
            </div>
        </div>
        <div class="project__details">
            <div class="project__buttons-group">
                {% if project.estimates %}
                    <a href="{{ project.estimates.url }}" class="project__download-estimates">
                        <button>Скачать смету</button>
                    </a>
                {% endif %}
                <div class="project__discount">
                    <button>Скидка 5%</button>
                </div>
            </div>
            <div class="project__heading container">
                <h1>{{ project.name }}</h1>
                <hr>
            </div>
            <div class="project__buttons-group--adaptive container">
                {% if project.estimates %}
                    <a href="{{ project.estimates.url }}" class="project__download-estimates--adaptive">
                        <button>Скачать смету</button>
                    </a>
                {% endif %}
                <div class="project__discount--adaptive">
                    <button>Скидка 5%</button>
                </div>
            </div>
            <div class="project__slider--adaptive">
                {% for photo in project.photos.all %}
                    <div class="project__slide--adaptive">
                        <a href="{{ photo.image.url }}">
                            <img src="{{ photo.image.url }}" alt="">
                        </a>
                    </div>
                {% endfor %}
            </div>
            <div class="project__parameters container">
                <ul class="table-of-contents">
                    <li><span>Этажи</span><span>{{ project.floors_quantity }}</span></li>
                    <li><span>Площадь</span><span>{{ project.square }} м²</span></li>
                    <li><span>Количество спален</span><span>{{ project.bedrooms_quantity }}</span></li>
                    <li><span>Количество санузлов</span><span>{{ project.bathrooms_quantity }}</span></li>
                    <li><span>Материал</span><span>{{ project.material }}</span></li>
                    <li><span>Кровля</span><span>{{ project.roof_type }}</span></li>
                    <li><span>Стоимость</span><span>от {{ project.price|price_format }} р</span></li>
                </ul>
            </div>
            <div class="project__credit container">
                <div>Дом подходит под ипотеку,<br> или кредит</div>
            </div>
            <div class="project__order-button animated">
                <button>
                    <img src="{% static 'images/order.svg' %}" alt="">
                </button>
            </div>
        </div>
    </div>

    <div class="info container">
        <div class="info__heading">
            <p>Каркасные дома</p>
            <hr>
        </div>
        <div class="info__row">
            <div class="info__small-left-column">
            </div>
            <div class="info__big-right-column">
                <div class="info__paragraph">
                    <p class="font__inter">Каркасные дома - одни из самых известных на рынке загородного жилья. Основное преимущество «карманников» - скорость и доступность строительства</p>
                    <p class="font__inter">Каркасный дом - это дом, в основе которого есть несущий деревянный каркас. Он в свою очередь заполняется современными материалами для влаго-, ветро- и теплозащиты: Изоспан А, изоспин В, утеплитель Технониколь, и обшивается отделочными материалами (панели «Доке, имитация бруса, Данил «Ханья»). По завершении работ стена каркасного дома напоминает слоеный пиро</p>
                    <p class="font__inter">Как и любая технология, каркас со временем пережил несколько трансформации. Сегодня более половины строящихся частных домов возводятся по каркасной технологии. Это могут быть и загородные дома, и коттеджи с современным интерьером, которые подходят для круглогодичного проживания</p>
                    <p class="font__inter">Технология каркасного домостроения подходит для регионов с разным климатом. Эти дома подходят не только холодных регионов, но и для зон с повышенной сейсмической активностью</p>
                </div>
            </div>
        </div>
    </div>

    <div class="similar-projects container">
        <div>
            <h4 class="similar-projects__heading">Похожие проекты</h4>
        </div>
        <div class="similar-projects__cards">
            {% for project in similar_projects %}
                <div class="similar-projects__slider-item">
                    <div class="photo-slider">
                        {% for photo in project.photos.all %}
                            <div class="similar-projects__card-image photo-slider-item">
                                <img src="{{ photo.image.url }}" alt="">
                            </div>
                        {% endfor %}
                    </div>
                    <div class="similar-projects__card-text-container">
                        <div class="similar-projects__card-heading">
                            <a href="{{ project.get_absolute_url }}">{{ project.name }}</a>
                        </div>
                        <hr>
                        <div class="similar-projects__card-content">
                            <ul class="table-of-contents">
                                <li><span>Площадь</span><span>{{ project.square }} м²</span></li>
                                <li><span>Количество спален</span><span>{{ project.bedrooms_quantity }}</span></li>
                                <li><span>Количество санузлов</span><span>{{ project.bathrooms_quantity }}</span></li>
                                <li><span>Стоимость</span><span>от {{ project.price|price_format }} р</span></li>
                            </ul>
                        </div>
                    </div>
                    <div class="similar-projects__order-button openModal">
                        <button>Заказать строительство</button>
                    </div>
                    <div class="similar-projects__more-button">
                        <a href="{{ project.get_absolute_url }}">Узнать подробнее</a>
                    </div>
                </div>
            {% endfor %}
        </div>
        <div class="similar-projects--adaptive">
            <!-- <div class="catalog__cards"> -->
                {% for project in similar_projects %}
                    <div class="catalog__card">
                        <div class="photo-slider">
                            {% for photo in project.photos.all %}
                                <div class="best-projects__card-image photo-slider-item">
                                    <img src="{{ photo.image.url }}" alt="">
                                </div>
                            {% endfor %}
                        </div>
                        <div class="best-projects__card-text-container">
                            <div class="best-projects__card-heading">
                                <a href="{{ project.get_absolute_url }}">{{ project.name }}</a>
                            </div>
                            <hr>
                            <div class="best-projects__card-content">
                                <ul class="table-of-contents">
                                    <li><span>Площадь</span><span>{{ project.square }} м2</span></li>
                                    <li><span>Количество спален</span><span>{{ project.bedrooms_quantity }}</span></li>
                                    <li><span>Количество санузлов</span><span>{{ project.bathrooms_quantity }}</span></li>
                                    <li><span>Стоимость</span><span>от {{ project.price|floatformat:0 }} р</span></li>
                                </ul>
                            </div>
                        </div>
                        <div class="best-projects__order-button">
                            <button>Заказать строительство</button>
                        </div>
                        <div class="best-projects__more-button">
                            <a href="{{ project.get_absolute_url }}">Узнать подробнее</a>
                        </div>
                    </div>
                {% endfor %}
            <!-- </div> -->
        </div>
    </div>

    <div class="contacts container">
        <div class="contacts__small-left-column">
            <div class="contacts__heading">
                <h4>Контакты</h4>
            </div>
            <div class="contacts__block">
                <div>
                    <img src="{% static 'images/contacts-icon-1.svg' %}" alt="">
                </div>
                <div>
                    <div class="contacts__block-heading">
                        <p>Главный офис:</p>
                    </div>
                    <div class="font__inter">
                        <p>г. Владивосток, Волгоградская 7</p>
                    </div>
                </div>
            </div>
            <div class="contacts__block">
                <div>
                    <img src="{% static 'images/contacts-icon-2.svg' %}" alt="">
                </div>
                <div>
                    <div class="contacts__block-heading">
                        <p>Время работы:</p>
                    </div>
                    <div  class="font__inter">
                        <p>ПН-СБ с 10:00 - 18:00</p>
                    </div>
                </div>
            </div>
            <div class="contacts__block">
                <div>
                    <img src="{% static 'images/contacts-icon-3.svg' %}" alt="">
                </div>
                <div>
                    <div class="contacts__block-heading">
                        <p>Телефон:</p>
                    </div>
                    <div  class="font__inter">
                        <p>+7 (908) 998-58-70</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="contacts__big-right-column">
            <div class="map" id="map">

            </div>
        </div>
    </div>

{% endblock %}

{% block script %}
<!-- Открытие фотографий на весь экран при нажатии -->
<script type=module src="{% static 'js/luminous-lightbox/luminous-lightbox.js' %}"></script>
<style type="text/css" class="lum-base-styles">
    @keyframes lum-noop {
      0% {
        zoom:1
      }
    }
    .lum-lightbox {
      position: fixed;
      display: none;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
    }
  
    .lum-lightbox.lum-open {
      display: block;
      z-index: 1000000
    }
  
    .lum-lightbox.lum-closing,
    .lum-lightbox.lum-opening {
      animation: lum-noop 1ms
    }
  
    .lum-lightbox-inner {
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      overflow: hidden
    }
  
    .lum-lightbox-loader {
      display: none
    }
  
    .lum-lightbox-inner img {
      max-width: 100%;
      max-height: 100%
    }
  
    .lum-lightbox-image-wrapper {
      vertical-align: middle;
      display: table-cell;
      text-align: center;
      background-color: rgba(0, 0, 0, 0.5);
    }

    .lum-img {
        object-fit: cover !important;
        width: 85vw;
    }

    @media (max-width: 990px) {
        .lum-img {
            width: 100vw;
        }
    }
</style>
<script type=module>
import { L as LuminousGallery } from "/static/js/luminous-lightbox/luminous-lightbox.js";

function initGallery() {
  var galleryItems = document.querySelectorAll(".project__current-slide a")
    if (galleryItems.length > 0) {
        new LuminousGallery(galleryItems);
    }

    var mobileGalleryItems = document.querySelectorAll(".project__slide--adaptive a");
    console.log(mobileGalleryItems)
    if (galleryItems.length > 0) {
        new LuminousGallery(mobileGalleryItems );
    }
}
initGallery();
</script>
<!-- Слайдеры -->
<script>
    $('.project__current-slide').slick({
      slidesToShow: 1,
      slidesToScroll: 1,
      arrows: true,
      fade: true,
      asNavFor: '.project__slider-nav'
    });
    $('.project__slider-nav').slick({
      slidesToShow: 3,
      slidesToScroll: 1,
      asNavFor: '.project__current-slide',
      dots: false,
      arrows: false,
      focusOnSelect: true, 
    });
    $('.project__slider--adaptive').slick({
        centerMode: true,
      slidesToShow: 1,
      slidesToScroll: 1,
      dots: false,
      arrows: false,
      focusOnSelect: true, 
      responsive: [
            {
                breakpoint: 1200, 
                settings: {
                    slidesToShow: 2, 
                    slidesToScroll: 1
                }
            },
            {
                breakpoint: 820, 
                settings: {
                    slidesToShow: 1, 
                    slidesToScroll: 1
                }
            }, 
            {
                breakpoint: 576, 
                settings: {
                    slidesToShow: 1, 
                    slidesToScroll: 1, 
                }
            }
        ]
    });
    $(document).ready(function () {
        $('.similar-projects__cards').slick({
            arrows: true,
            infinite: true,
            slidesToShow: 3,
            slidesToScroll: 1, 
            responsive: [
                {
                    breakpoint: 1024, 
                    settings: {
                        slidesToShow: 3, 
                        slidesToScroll: 1
                    }
                },
                {
                    breakpoint: 768, 
                    settings: {
                        centerMode: true,
                        slidesToShow: 2, 
                        slidesToScroll: 1
                    }
                }, 
                {
                    breakpoint: 576, 
                    settings: {
                        centerMode: true,
                        slidesToShow: 1, 
                        slidesToScroll: 1, 
                    }
                }
            ]
        });
    });
    $(document).ready(function () {
        $('.photo-slider').slick({
            dots: true,
            infinite: true,
            speed: 500,
            slidesToShow: 1,
            adaptiveHeight: false,
            autoplay: false,
            arrows: false,
        });
    });
    
    // Яндекс карты
    var myMap;
    ymaps.ready(function(){
        myMap = new ymaps.Map("map", {
            center: [43.157062, 131.926061], 
            zoom: 16, 
            controls: []
        });
        var o = new ymaps.control.ZoomControl({
              options: {
                  position: {
                      right: 10,
                      top: 50
                  },
                  size: "small"
              }
          });
        myMap.controls.add(o);
        myMap.behaviors.disable("scrollZoom");
        var s = new ymaps.Placemark([43.157062, 131.926061], {
                  hintContent: "Волгоградская улица, 7А",
                  balloonContent: "Волгоградская улица, 7А"
              }, {
                  iconLayout: "default#image",
                  iconImageHref: `/static/images/pin.svg`,
                  iconImageSize: [30, 42],
                  iconImageOffset: [-15, -42]
              });
        myMap.geoObjects.add(s);
    }); 
    </script>
{% endblock %}